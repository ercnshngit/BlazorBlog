@page "/create"
@inject BlazorBlog.Client.Services.IBlogService BlogService
@inject NavigationManager NavigationManager

<h3>Create a New Post</h3>

<EditForm Model="@newBlogPost" OnValidSubmit="CreateNewBlogPost">
	<DataAnnotationsValidator />
	<div class="form-group">
		<label for="title">Title</label>
		<InputText id="title" @bind-Value="newBlogPost.Title" class="form-control" />
		<ValidationMessage For="@(()=> newBlogPost.Title)" />
	</div>
	<div class="form-group">
		<label for="slug">Slug</label>
		<InputText id="slug" @bind-Value="newBlogPost.Slug" class="form-control" />
		<ValidationMessage For="@(()=> newBlogPost.Slug)" />
	</div>
	<div class="form-group">
		<label for="author">Author</label>
		<InputText id="author" @bind-Value="newBlogPost.Author" class="form-control" />
		<ValidationMessage For="@(()=> newBlogPost.Author)" />
	</div>
	<div class="form-group">
		<label for="content">Content</label>
		<InputTextArea id="content" @bind-Value="newBlogPost.Content" class="form-control" />
	</div>
	<div class="form-group">
		<label for="date">Date</label>
		<InputDate id="date" @bind-Value="newBlogPost.Created" class="form-control" />
	</div>
	<div class="form-check">
		<InputCheckbox id="isPublished" @bind-Value="newBlogPost.IsPublished" class="form-check-input" />
		<label for="isPublished">Publish</label>
	</div>
	<button type="submit" class="btn btn-primary">Create</button>
	<ValidationSummary />
</EditForm>


@code {
	BlazorBlog.Shared.BlogPost newBlogPost = new BlazorBlog.Shared.BlogPost();

	async void CreateNewBlogPost()
	{
		var result = await BlogService.CreateNewBlogPost(newBlogPost);
		NavigationManager.NavigateTo($"posts/{result.Slug}");
	}
}
